<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Copyright (C) 2016-2017 Franco Masotti franco.masotti@student.unife.it

Copying and distribution of this file, with or without modification,
are permitted in any medium without royalty provided the copyright
notice and this notice are preserved. -->
<!-- Created by GNU Texinfo 6.3, http://www.gnu.org/software/texinfo/ -->
<head>
<title>Cplint R Manual</title>

<meta name="description" content="Cplint R Manual">
<meta name="keywords" content="Cplint R Manual">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="#Top" rel="start" title="Top">
<link href="#SEC_Contents" rel="contents" title="Table of Contents">
<link href="dir.html#Top" rel="up" title="(dir)">
<style type="text/css">
<!--
/*
 * main.css
 *
 * Copyright (C) 2016 frnmst (Franco Masotti) <franco.masotti@student.unife.it>
 *
 * This file is part of swish-installer.
 *
 * cplint_r is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * cplint_r is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with cplint_r.  If not, see <http://www.gnu.org/licenses/>.
 *
 */


a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
:root {
    background-color: #fafafa;
    color: #040404;
}

a {
    background-color: #fafafa;
    color: #0000ff;
    /* No grey dotted border. */
    outline: 0;
    border-style: none;
}

a:hover {
    background-color: #040404;
    color: #fafafa;
    -webkit-transition-duration: 0.4s;
    transition-duration: 0.4s;
    border-radius: 24em;
    text-decoration: none;
}

td {
    resize: both;
    overflow: auto;
}


-->
</style>


</head>

<body lang="en">
<h1 class="settitle" align="center">Cplint R Manual</h1>














































<a name="SEC_Contents"></a>
<h2 class="contents-heading">Table of Contents</h2>

<div class="contents">

<ul class="no-bullet">
  <li><a name="toc-About" href="#Description">1 About</a>
  <ul class="no-bullet">
    <li><a name="toc-About-1" href="#About-1">1.1 About</a></li>
    <li><a name="toc-Terminology" href="#Terminology">1.2 Terminology</a></li>
  </ul></li>
  <li><a name="toc-Installation-1" href="#Installation">2 Installation</a>
  <ul class="no-bullet">
    <li><a name="toc-Dependencies" href="#Dependencies">2.1 Dependencies</a>
    <ul class="no-bullet">
      <li><a name="toc-Prolog" href="#Prolog">2.1.1 Prolog</a></li>
      <li><a name="toc-R-1" href="#R-1">2.1.2 R</a></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Examples-1" href="#Examples">3 Examples</a>
  <ul class="no-bullet">
    <li><a name="toc-Gaussian-mean-estimation" href="#Gaussian-mean-estimation">3.1 Gaussian mean estimation</a></li>
    <li><a name="toc-Other-examples" href="#Other-examples">3.2 Other examples</a></li>
  </ul></li>
  <li><a name="toc-Protocol-1" href="#Protocol">4 Protocol</a>
  <ul class="no-bullet">
    <li><a name="toc-Interface" href="#Interface">4.1 Interface</a></li>
    <li><a name="toc-Internals" href="#Internals">4.2 Internals</a>
    <ul class="no-bullet">
      <li><a name="toc-Interface-predicates" href="#Interface-predicates">4.2.1 Interface predicates</a></li>
      <li><a name="toc-Plotting-predicates" href="#Plotting-predicates">4.2.2 Plotting predicates</a></li>
      <li><a name="toc-List-handling" href="#List-handling">4.2.3 List handling</a></li>
      <li><a name="toc-Main-data-frame-creation" href="#Main-data-frame-creation">4.2.4 Main data frame creation</a></li>
      <li><a name="toc-Helpers" href="#Helpers">4.2.5 Helpers</a></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Development-1" href="#Development">5 Development</a>
  <ul class="no-bullet">
    <li><a name="toc-Changing-the-library" href="#Changing-the-library">5.1 Changing the library</a></li>
    <li><a name="toc-Compiling-this-documentation" href="#Compiling-this-documentation">5.2 Compiling this documentation</a></li>
  </ul></li>
  <li><a name="toc-Thanks-1" href="#Thanks">6 Thanks</a></li>
  <li><a name="toc-References-1" href="#References">7 References</a></li>
</ul>
</div>


<a name="Top"></a>
<div class="header">
<p>
Next: <a href="#Description" accesskey="n" rel="next">Description</a>, Up: <a href="dir.html#Top" accesskey="u" rel="up">(dir)</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Cplint-R"></a>
<h1 class="top">Cplint R</h1>

<p>This manual is for Cplint R program version 1.0.0
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Description" accesskey="1">Description</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">A brief description of what this is all about
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Installation" accesskey="2">Installation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Installation procedures on various systems
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Examples" accesskey="3">Examples</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Trivial examples to explain how to use the library
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Protocol" accesskey="4">Protocol</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Formal descriprion of the protocol
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Development" accesskey="5">Development</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">A thorough description on how to develop this library
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Thanks" accesskey="6">Thanks</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">People and communities
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#References" accesskey="7">References</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">References to the technologies used
</td></tr>
</table>


<hr>
<a name="Description"></a>
<div class="header">
<p>
Next: <a href="#Installation" accesskey="n" rel="next">Installation</a>, Previous: <a href="#Top" accesskey="p" rel="prev">Top</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="About"></a>
<h2 class="chapter">1 About</h2>
<a name="About-1"></a>
<h3 class="section">1.1 About</h3>
<p>The purpose of this library is to provide an interface between
the Cplint<a name="DOCF1" href="#FOOT1"><sup>1</sup></a> suite for 
SWI Prolog<a name="DOCF2" href="#FOOT2"><sup>2</sup></a>
and R<a name="DOCF3" href="#FOOT3"><sup>3</sup></a>
to handle charts made with the ggplot2<a name="DOCF4" href="#FOOT4"><sup>4</sup></a> package.
</p>
<p>This means that most C3js<a name="DOCF5" href="#FOOT5"><sup>5</sup></a>
charting functions of Cplint are also available for R.
</p>
<a name="Terminology"></a>
<h3 class="section">1.2 Terminology</h3>
<p>In order to simplify the understanding of this document, a minimal set of
terminology is necessary:
</p>
<ul>
<li> Any code between <code>&lt;</code> <code>&gt;</code> represents pseudocode.

</li><li> The symbol <code>#</code> represents an unsigned integer or the <code>root</code> user, 
depending on the context.

</li><li> Optional code or parameters are encapsuled between <code>[</code> <code>]</code>.

</li></ul>


<hr>
<a name="Installation"></a>
<div class="header">
<p>
Next: <a href="#Examples" accesskey="n" rel="next">Examples</a>, Previous: <a href="#Description" accesskey="p" rel="prev">Description</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Installation-1"></a>
<h2 class="chapter">2 Installation</h2>
<p>Cplint R is provided as part of the
Cplint on SWISH<a name="DOCF6" href="#FOOT6"><sup>6</sup></a>
package. This is the recomended and simplest way to obtain a working
installation without too much trouble.
</p>
<p>You can also install it manually with <code>pack_install('cplint_r').</code>
using the <code>swipl</code> command on UNIX-like systems. Unfortunately, doing 
this is not enough since you need to setup an R environment with the 
components described in the following section. For more information, have a
look at the
SWISH Installer Manual<a name="DOCF7" href="#FOOT7"><sup>7</sup></a>
</p>
<a name="Dependencies"></a>
<h3 class="section">2.1 Dependencies</h3>
<p>Cplint R has both Prolog and R dependencies:
</p>
<a name="Prolog"></a>
<h4 class="subsection">2.1.1 Prolog</h4>
<ul>
<li> Cplint

</li><li> Rserve Client<a name="DOCF8" href="#FOOT8"><sup>8</sup></a>

</li><li> R SWISH library<a name="DOCF9" href="#FOOT9"><sup>9</sup></a>

</li></ul>

<a name="R-1"></a>
<h4 class="subsection">2.1.2 R</h4>
<ul>
<li> ggplot2

</li><li> Rserve<a name="DOCF10" href="#FOOT10"><sup>10</sup></a>

</li><li> gridExtra<a name="DOCF11" href="#FOOT11"><sup>11</sup></a>

</li></ul>


<hr>
<a name="Examples"></a>
<div class="header">
<p>
Next: <a href="#Protocol" accesskey="n" rel="next">Protocol</a>, Previous: <a href="#Installation" accesskey="p" rel="prev">Installation</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Examples-1"></a>
<h2 class="chapter">3 Examples</h2>
<a name="Gaussian-mean-estimation"></a>
<h3 class="section">3.1 Gaussian mean estimation</h3>
<p>The following is the content of <samp>gauss_mean_est_R.pl</samp>.
</p>
<pre class="verbatim">/*
Posterior estimation in Bayesian models.
We are trying to estimate the true value of a Gaussian distributed random
variable, given some observed data. The variance is known (2) and we 
suppose that the mean has a Gaussian distribution with mean 1 and variance
5. We take different measurement (e.g. at different times), indexed
with an integer.
Given that we observe 9 and 8 at indexes 1 and 2, how does the distribution 
of the random variable (value at index 0) changes with respect to the case of 
no observations?
From
http://www.robots.ox.ac.uk/~fwood/anglican/examples/viewer/?worksheet=gaussian-posteriors
*/
:- use_module(library(mcintyre)).
:- use_module(library(cplint_r)).

:- mc.
:- begin_lpad.

value(I,X) :- 
  mean(M),
  value(I,M,X).
% at time I we see X sampled from a Gaussian with mean M and variamce 2.0

mean(M): gaussian(M,1.0, 5.0).
% Gaussian distribution of the mean of the Gaussian of the variable

value(_,M,X): gaussian(X,M, 2.0).
% Gaussian distribution of the variable


:- end_lpad.

hist_uncond(Samples,NBins):-
  mc_sample_arg(value(0,X),Samples,X,L0),
  histogram_r(L0,NBins).
% plot an histogram of the density of the random variable before any 
% observations by taking Samples samples and by dividing the domain
% in NBins bins

dens_lw(Samples):-
  mc_sample_arg(value(0,Y),Samples,Y,L0),
  mc_lw_sample_arg(value(0,X),(value(1,9),value(2,8)),Samples,X,L),
  densities_r(L0,L).
% plot the densities of the random variable before and after  
% observing 9 and 8 by taking Samples samples.



/** &lt;examples&gt;
?- dens_lw(1000).
% plot the densities of the random variable before and after
% observing 9 and 8
?- hist_uncond(10000,40).
% plot an histogram of the density of the random variable before any
% observations
?-  mc_lw_expectation(value(0,X),(value(1,9),value(2,8)),1000,X,E).
% E = 7.166960047178755
?- mc_expectation(value(0,X),10000,X,E).
% E = 0.9698875384639362.

*/
 
</pre>
<p>Using <code>?- dens_lw(1000)</code> as query the following chart is produced:
</p>
<img src="example_out.png" alt="example_out">

<a name="Other-examples"></a>
<h3 class="section">3.2 Other examples</h3>
<p>For other examples see all the files ending in &quot;_R.pl&quot; on 
<a href="https://github.com/friguzzi/swish/tree/master/examples/inference">https://github.com/friguzzi/swish/tree/master/examples/inference</a>
</p>

<hr>
<a name="Protocol"></a>
<div class="header">
<p>
Next: <a href="#Development" accesskey="n" rel="next">Development</a>, Previous: <a href="#Examples" accesskey="p" rel="prev">Examples</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Protocol-1"></a>
<h2 class="chapter">4 Protocol</h2>
<a name="Interface"></a>
<h3 class="section">4.1 Interface</h3>
<p>The following is a list of exported predicates available
to the library users&rsquo;.
</p>
<p>Each predicate corresponds to one of the following categories
</p><ul>
<li> Helper: specific of this library.

</li><li> Pita: part of Cplint.

</li><li> Mcintyre: part of Cplint.

</li><li> Auc: part of Cplint.
</li></ul>

<p>Each argument of a predicate correponds to a data type. See
the SWI Prolog data types manual<a name="DOCF12" href="#FOOT12"><sup>12</sup></a> 
and the Learn Prolog Now manual<a name="DOCF13" href="#FOOT13"><sup>13</sup></a>.
Have a look at the Cplint help manual<a name="DOCF14" href="#FOOT14"><sup>14</sup></a> to learn in 
details about the functionality of each predicate.
</p>
<dl>
<dt><a name="index-build_005fxy_005flist_0028_002bX_003alist_002c_002bY_003alist_002c_002dOut_003alist_0029"></a>Helper: <strong>build_xy_list(+<var>X</var>:list,+<var>Y</var>:list,-<var>Out</var>:list)</strong> <em>is det</em></dt>
<dd><p>Given to lists <var>X</var> and <var>Y</var> build an output list <var>Out</var>
in the form <code>[X1-Y1,X2-Y2,...,XN-YN]</code>.
</p></dd></dl>

<dl>
<dt><a name="index-r_005frow_0028_002bX_003aatom_002c_002bY_003aatom_002c_002dOut_003aatom_0029"></a>Helper: <strong>r_row(+<var>X</var>:atom,+<var>Y</var>:atom,-<var>Out</var>:atom)</strong> <em>is det</em></dt>
<dd><p>Given two atoms <var>X</var> and <var>Y</var>, build the term <code>r(X,Y)</code>
in <var>Out</var>.
</p></dd></dl>

<dl>
<dt><a name="index-get_005fset_005ffrom_005fxy_005flist_0028_002bL_003alist_002c_002dR_003alist_0029"></a>Helper: <strong>get_set_from_xy_list(+<var>L</var>:list,-<var>R</var>:list)</strong> <em>is det</em></dt>
<dd><p>Given an input list <var>L</var> in the form <code>[X1-Y1,X2-Y2,...,XN-YN]</code>,
transform it in an output list <var>R</var> in the form
<code>[r(X1,Y1),r(X2,Y2),...,r(XN,YN)]</code>.
This means that <code>R</code> will contain an X-Y relationship
which can be then passed to an R data frame.
</p></dd></dl>

<dl>
<dt><a name="index-prob_005fbar_005fr_0028_003aQuery_003aatom_0029"></a>Pita: <strong>prob_bar_r(:<var>Query</var>:atom)</strong> <em>is nondet</em></dt>
<dd><p>The predicate computes and plots the probability of <var>Query</var>
as a bar chart with a bar for the probability of <var>Query</var> true and
a bar for the probability of <var>Query</var> false.
If <var>Query</var> is not ground, it returns in backtracking all ground
instantiations of <var>Query</var> together with their probabilities.
</p></dd></dl>

<dl>
<dt><a name="index-prob_005fbar_005fr_0028_003aQuery_003aatom_002c_003aEvidence_003aatom_0029"></a>Pita: <strong>prob_bar_r(:<var>Query</var>:atom,:<var>Evidence</var>:atom)</strong> <em>is nondet</em></dt>
<dd><p>The predicate computes and plots the probability of <var>Query</var>
given <var>Evidence</var>
as a bar chart with a bar for the probability of <var>Query</var> true and
a bar for the probability of <var>Query</var> false given <var>Evidence</var>.
If <var>Query</var> / <var>Evidence</var> are not ground, it returns in backtracking all 
ground
instantiations of <var>Query</var> / <var>Evidence</var> together with their 
probabilities.
</p></dd></dl>

<dl>
<dt><a name="index-mc_005fprob_005fbar_005fr_0028_003aQuery_003aatom_002c_002dProbability_003adict_0029"></a>Mcintyre: <strong>mc_prob_bar_r(:<var>Query</var>:atom,-<var>Probability</var>:dict)</strong> <em>is det</em></dt>
<dd><p>See prob_bar_r/2.
</p></dd></dl>

<dl>
<dt><a name="index-mc_005fsample_005fbar_005fr_0028_003aQuery_003aatom_002c_002bSamples_003aint_0029"></a>Mcintyre: <strong>mc_sample_bar_r(:<var>Query</var>:atom,+<var>Samples</var>:int)</strong> <em>is det</em></dt>
<dd><p>The predicate samples <var>Query</var> a number of <var>Samples</var> times and
plots a bar chart with a bar for the number of successes and a bar for the
number of failures.
If <var>Query</var> is not ground, it considers it as an existential query.
</p></dd></dl>

<dl>
<dt><a name="index-mc_005fsample_005farg_005fbar_005fr_0028_003aQuery_003aatom_002c_002bSamples_003aint_002c_003fArg_003avar_0029"></a>Mcintyre: <strong>mc_sample_arg_bar_r(:<var>Query</var>:atom,+<var>Samples</var>:int,?<var>Arg</var>:var)</strong> <em>is det</em></dt>
<dd><p>The predicate samples <var>Query</var> <var>Samples</var> times. <var>Arg</var> should be a variable
in <var>Query</var>.
The predicate plots a bar chart
with a bar for each possible value of L,
the list of values of <var>Arg</var> for which <var>Query</var> succeeds in
a world sampled at random.
The size of the bar is the number of samples
returning that list of values.
</p></dd></dl>

<dl>
<dt><a name="index-mc_005fsample_005farg_005ffirst_005fbar_005fr_0028_003aQuery_003aatom_002c_002bSamples_003aint_002c_003fArg_003avar_0029"></a>Mcintyre: <strong>mc_sample_arg_first_bar_r(:<var>Query</var>:atom,+<var>Samples</var>:int,?<var>Arg</var>:var)</strong> <em>is det</em></dt>
<dd><p>The predicate samples <var>Query</var> <var>Samples</var> times. <var>Arg</var> should be a variable
in <var>Query</var>.
The predicate plots a bar chart
with a bar for each value of <var>Arg</var> returned as a first answer by <var>Query</var> in
a world sampled at random.
The size of the bar is the number of samples that returned that value.
The value is failure if the query fails.
</p></dd></dl>

<dl>
<dt><a name="index-mc_005frejection_005fsample_005farg_005fbar_005fr_0028_003aQuery_003aatom_002c_003aEvidence_003aatom_002c_002bSamples_003aint_002c_003fArg_003avar_0029"></a>Mcintyre: <strong>mc_rejection_sample_arg_bar_r(:<var>Query</var>:atom,:<var>Evidence</var>:atom,+<var>Samples</var>:int,?<var>Arg</var>:var)</strong> <em>is det</em></dt>
<dd><p>The predicate calls <code>mc_rejection_sample_arg/5</code> and builds an R graph
of the results.
It plots a bar chart with a bar for each possible value of L,
the list of values of <var>Arg</var> for which <var>Query</var> succeeds
given that <var>Evidence</var> is true
The size of the bar is the number of samples
returning that list of values.
</p></dd></dl>

<dl>
<dt><a name="index-mc_005fmh_005fsample_005farg_005fbar_005fr_0028_003aQuery_003aatom_002c_003aEvidence_003aatom_002c_002bSamples_003aint_002c_002bLag_003aint_002c_003fArg_003avar_0029"></a>Mcintyre: <strong>mc_mh_sample_arg_bar_r(:<var>Query</var>:atom,:<var>Evidence</var>:atom,+<var>Samples</var>:int,+<var>Lag</var>:int,?<var>Arg</var>:var)</strong> <em>is det</em></dt>
<dd><p>The predicate calls <code>mc_mh_sample_arg/6</code> and builds an R graph
of the results.
The predicate plots a bar chart
with a bar for each possible value of L,
the list of values of <var>Arg</var> for which <var>Query</var> succeeds in
a world sampled at random.
The size of the bar is the number of samples
returning that list of values.
</p></dd></dl>

<dl>
<dt><a name="index-mc_005fmh_005fsample_005farg_005fbar_005fr_0028_003aQuery_003aatom_002c_003aEvidence_003aatom_002c_002bSamples_003aint_002c_002bMix_003aint_002c_002bLag_003aint_002c_003fArg_003avar_0029"></a>Mcintyre: <strong>mc_mh_sample_arg_bar_r(:<var>Query</var>:atom,:<var>Evidence</var>:atom,+<var>Samples</var>:int,+<var>Mix</var>:int,+<var>Lag</var>:int,?<var>Arg</var>:var)</strong> <em>is det</em></dt>
<dd><p>The predicate calls <code>mc_mh_sample_arg/7</code> and builds an R graph
of the results.
The predicate plots a bar chart
with a bar for each possible value of L,
the list of values of <var>Arg</var> for which <var>Query</var> succeeds in
a world sampled at random.
The size of the bar is the number of samples
returning that list of values.
</p></dd></dl>

<dl>
<dt><a name="index-histogram_005fr_0028_002bList_003alist_002c_002bNBins_003aint_0029"></a>Mcintyre: <strong>histogram_r(+<var>List</var>:list,+<var>NBins</var>:int)</strong> <em>is det</em></dt>
<dd><p>Draws a histogram of the samples in List dividing the domain in
<var>NBins</var> bins. <var>List</var> must be a list of couples of the form [V]-W or V-W
where V is a sampled value and W is its weight.
</p></dd></dl>

<dl>
<dt><a name="index-density_005fr_0028_002bList_003alist_0029"></a>Mcintyre: <strong>density_r(+<var>List</var>:list)</strong> <em>is det</em></dt>
<dd><p>Display a smooth density estimate of a sets of samples.
The samples are in <var>List</var>
as couples V-W where V is a value and W its weigth.
</p></dd></dl>


<dl>
<dt><a name="index-densities_005fr_0028_002bPriorList_003alist_002c_002bPostList_003alist_0029"></a>Mcintyre: <strong>densities_r(+<var>PriorList</var>:list,+<var>PostList</var>:list)</strong> <em>is det</em></dt>
<dd><p>Display a smooth density estimate of two sets of samples, usually
prior and post observations. The samples from the prior are in <var>PriorList</var>
while the samples from the posterior are in <var>PostList</var>
as couples V-W where V is a value and W its weigth.
</p></dd></dl>


<dl>
<dt><a name="index-compute_005fareas_005fdiagrams_005fr_0028_002bLG_003alist_002c_002dAUCROC_003afloat_002c_002dAUCPR_003afloat_0029"></a>Auc: <strong>compute_areas_diagrams_r(+<var>LG</var>:list,-<var>AUCROC</var>:float,-<var>AUCPR</var>:float)</strong> <em>is det</em></dt>
<dd><p>The predicate takes as input
a list <var>LG</var> of pairs probability-literal in asceding order on probability
where the literal can be an Atom (incading a positive example) or \+ Atom,
indicating a negative example while the probability is the probability of
Atom of being true. PR and ROC diagrams are plotted.
The predicate returns:
</p><ul>
<li> <var>AUCROC</var>: the size of the area under the ROC curve

</li><li> <var>AUCPR</var>: the size of the area under the PR curve
</li></ul>

<p>See <a href="http://cplint.lamping.unife.it/example/exauc.pl">http://cplint.lamping.unife.it/example/exauc.pl</a> for an example.
</p></dd></dl>

<a name="Internals"></a>
<h3 class="section">4.2 Internals</h3>
<p>Important predicates in this library follow a common structure to avoid 
confusion and promote standardization.
</p>
<p>Interface predicates are involved in the interaction between input data from a 
program and the plot of that same data. These predicates are usable from the 
programs.
</p>
<p>As the name suggests, plotting predicates are only involved in plotting the 
data.
</p>
<p>Finally there are other functions which handle the lists and other types of 
data.
</p>
<a name="Interface-predicates"></a>
<h4 class="subsection">4.2.1 Interface predicates</h4>
<p>All interface predicates have a similar structure. Their names
end with <code>_r</code> (except the Helpers) in order to distinguish them from the 
original Cplint predicates.
</p>
<p>First and last operations are always <code>load_r_libraries</code> and 
<code>finalize_r_graph</code> respectively.
</p>
<p>Plotting is done right before the last operation with one of the <code>geom_</code>
predicates.
</p>
<p>A skeleton of the structure follows.
</p><pre class="verbatim">&lt;cplint_graphing_predicate&gt;_r(&lt;input&gt;):-
    load_r_libraries,
    &lt;operations on the input&gt;,
    geom_&lt;something&gt;(&lt;new input, possibly lists&gt;),
    finalize_r_graph.
</pre>
<a name="Plotting-predicates"></a>
<h4 class="subsection">4.2.2 Plotting predicates</h4>
<p>Predicates directly involved in plotting all start with <code>geom_</code> as prefix.
</p>
<p>These predicates work with lists which are then transformed into R data frames, 
and, as a final instruction, a corresponding plot is generated.
</p>
<p>You can visualize the structure with the following pseudocode:
</p><pre class="verbatim">geom_&lt;something&gt;(&lt;Lists and/or other input&gt;) :-
    &lt;handle lists&gt;,
    &lt;create one or more R data frame with the lists data&gt;,
    &lt;rename data frame colnames to avoid using default ones&gt;,
    &lt;- ggplot &lt;something&gt;
</pre>
<a name="List-handling"></a>
<h4 class="subsection">4.2.3 List handling</h4>
<p>List handling is useful to pass information between Prolog and
R. This is done thanks to <code>build_xy_list/3</code>, <code>r_row/3</code> 
and <code>get_set_from_xy_list/2</code> predicates, 
described in the interface section.
</p>
<p>In case there are multiple distributions we simply have to call
<code>get_set_from_xy_list/2</code> the appropriate number of times,
like: <code>get_set_from_xy_list(&lt;something&gt;,R#)</code>.
</p>
<a name="Main-data-frame-creation"></a>
<h4 class="subsection">4.2.4 Main data frame creation</h4>
<p>As descibed before, a data frame is useful to pass 
structured information between Prolog and R.
</p>
<p>In Cplint R in particular, we use <code>r_data_frame_from_rows/2</code> provided by
the Rserve Client library, in the following
manner:
</p><pre class="verbatim">r_data_frame_from_rows(df[#], R[#])
</pre>
<p>For each distribution the optional number is incremented by one.
</p>
<p>In case it is the last (or only) data frame then its name
will simply be <code>df</code>.
</p>
<a name="Helpers"></a>
<h4 class="subsection">4.2.5 Helpers</h4>
<p>What follows are extracts of some trivial predicates indicated as internal 
helpers.
</p>
<pre class="verbatim">bin_width(Min,Max,NBins,Width) :-
  D is Max-Min,
  Width is D/NBins.

load_r_libraries :-
    &lt;- library(&quot;ggplot2&quot;).

finalize_r_graph :-
    r_download.
</pre>

<hr>
<a name="Development"></a>
<div class="header">
<p>
Next: <a href="#Thanks" accesskey="n" rel="next">Thanks</a>, Previous: <a href="#Protocol" accesskey="p" rel="prev">Protocol</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Development-1"></a>
<h2 class="chapter">5 Development</h2>
<a name="Changing-the-library"></a>
<h3 class="section">5.1 Changing the library</h3>
<p>You are welcomed to change this library. In order to test it you simply have to
place you modified version in the correct path and restart SWISH. If you have 
used the packages provided with SWISH Installer this can be achieved with the 
following:
</p><pre class="verbatim"># mv &lt;your_modified_cplint_r_library&gt; /home/swish/lib/swipl/pack/cplint_r/prolog/cplint_r.pl
# systemctl restart swish-cplint
</pre>
<a name="Compiling-this-documentation"></a>
<h3 class="section">5.2 Compiling this documentation</h3>
<p>The source of this documentation is under the <samp>doc</samp>
directory of the repository.
</p>
<p>To be able to compile it, you have to install several tex packages
(for example: <code>texlive-most</code> and <code>texi2html</code> if you are using
Arch Linux) that contain the following binaries:
</p>
<pre class="verbatim">makeinfo
texi2dvi
docbook2html
docbook2pdf
docbook2txt
texi2html
perl
</pre>
<p>After running <code>make</code>, a directory named <samp>manual</samp>
will be created and you can access all the files by opening
<samp>index.html</samp> with a browser.
</p>

<hr>
<a name="Thanks"></a>
<div class="header">
<p>
Next: <a href="#References" accesskey="n" rel="next">References</a>, Previous: <a href="#Development" accesskey="p" rel="prev">Development</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Thanks-1"></a>
<h2 class="chapter">6 Thanks</h2>
<p>Fabrizio Riguzzi for developement, testing and feedback.
</p>
<p>Raivo Laanemets for a blog
article<a name="DOCF15" href="#FOOT15"><sup>15</sup></a>
on how to write SWI Prolog packs.
</p>

<hr>
<a name="References"></a>
<div class="header">
<p>
Previous: <a href="#Thanks" accesskey="p" rel="prev">Thanks</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="References-1"></a>
<h2 class="chapter">7 References</h2>

<p>Some quotations reported here are taken directly from the respective web sites.
<br>
</p>
<ul>
<li> <a name="Cplint"></a><strong>[Cplint]</strong>
 &quot;A suite of programs for reasoning with probabilistic
logic programs&quot;. See <a href="https://github.com/friguzzi/cplint">https://github.com/friguzzi/cplint</a> and
<a href="https://github.com/friguzzi/cplint/blob/master/doc/help-cplint.pdf">https://github.com/friguzzi/cplint/blob/master/doc/help-cplint.pdf</a> for 
the Cplint help manual.
<br>

</li><li> <a name="SWI-Prolog"></a><strong>[SWI Prolog]</strong>
 &quot;SWI-Prolog offers a comprehensive 
free Prolog environment.
Since its start in 1987, SWI-Prolog development has been driven by the needs
of real world applications. SWI-Prolog is widely used in research and
education as well as commercial applications&quot;. See
<a href="http://www.swi-prolog.org/">http://www.swi-prolog.org/</a>
<br>

</li><li> <a name="R"></a><strong>[R]</strong>
 &quot;R is an integrated suite of software facilities for data 
manipulation, calculation and graphical display&quot;. 
See <a href="https://cran.r-project.org/doc/manuals/r-release/R-intro.html">https://cran.r-project.org/doc/manuals/r-release/R-intro.html</a>
<br>

</li><li> <a name="ggplot2"></a><strong>[ggplot2]</strong>
 &quot;ggplot2 is a plotting system for R, based on the grammar 
of graphics, which tries to take the good parts of base and lattice graphics 
and none of the bad parts. It takes care of many of the fiddly details that 
make plotting a hassle (like drawing legends) as well as providing a powerful 
model of graphics that makes it easy to produce complex multi-layered 
graphics&quot;.
See <a href="http://ggplot2.org/">http://ggplot2.org/</a>
<br>

</li><li> <a name="gridExtra"></a><strong>[gridExtra]</strong>
 &quot;Miscellaneous Functions for &quot;Grid&quot; Graphics.
Provides a number of user-level functions to work with &quot;grid&quot; graphics, 
notably to arrange multiple grid-based plots on a page, and draw tables&quot;.
See <a href="https://github.com/baptiste/gridextra">https://github.com/baptiste/gridextra</a>
<br>

</li><li> <a name="C3js"></a><strong>[C3js]</strong>
 &quot;C3 enables deeper integration of charts into your 
application&quot;.
See <a href="http://c3js.org/">http://c3js.org/</a>
<br>

</li><li> <a name="SWI-Prolog-data-types"></a><strong>[SWI Prolog data types]</strong>
 See 
<a href="http://www.swi-prolog.org/datatypes.html">http://www.swi-prolog.org/datatypes.html</a>.
<br>

</li><li> <a name="LPN"></a><strong>[LPN]</strong>
 &quot;Learn Prolog Now&quot;. See 
<a href="http://www.learnprolognow.org/lpnpage.php?pagetype=html&amp;pageid=lpn-htmlch1">http://www.learnprolognow.org/lpnpage.php?pagetype=html&amp;pageid=lpn-htmlch1</a>.
<br>

</li><li> <a name="Cplint-on-SWISH"></a><strong>[Cplint on SWISH]</strong>
 &quot;A set of packages that are able to build and 
install SWISH, Cplint on SWISH and an R environment&quot;. 
See <a href="https://frnmst.github.io/swish-installer/">https://frnmst.github.io/swish-installer/</a>
<br>

</li><li> <a name="Rserve-Client"></a><strong>[Rserve Client]</strong>
 &quot;SWI-Prolog/SWISH client for Rserve&quot;.
&quot;The container exposes Rserve using a Unix-domain socket in 
/home/rserve/socket&quot;.
See <a href="https://github.com/JanWielemaker/rserve_client">https://github.com/JanWielemaker/rserve_client</a>
<br>

</li><li> <a name="R-SWISH"></a><strong>[R SWISH]</strong>
 A library that talks between SWISH and Rserve.
See <a href="https://github.com/SWI-Prolog/swish/blob/master/lib/r_swish.pl">https://github.com/SWI-Prolog/swish/blob/master/lib/r_swish.pl</a>
<br>

</li><li> <a name="Rserve"></a><strong>[Rserve]</strong>
 &quot;Rserve is a TCP/IP server which allows other programs to 
use facilities of R (see www.r-project.org) from various languages without the 
need to initialize R or link against R library.&quot;
See <a href="https://www.rforge.net/Rserve/">https://www.rforge.net/Rserve/</a>
<br>

</li><li> <a name="SWISH-Installer-Manual"></a><strong>[SWISH Installer Manual]</strong>
 See 
<a href="https://frnmst.github.io/swish-installer/">https://frnmst.github.io/swish-installer/</a>
<br>

</li><li> <a name="Prolog-pack-development-experience"></a><strong>[Prolog pack development experience]</strong>
 See 
<a href="https://rlaanemets.com/post/show/prolog-pack-development-experience">https://rlaanemets.com/post/show/prolog-pack-development-experience</a>

</li></ul>

<div class="footnote">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h3><a name="FOOT1" href="#DOCF1">(1)</a></h3>
<p>See item <strong>[Cplint]</strong> in <a href="#References">Cplint</a>.
</p>
<h3><a name="FOOT2" href="#DOCF2">(2)</a></h3>
<p>See item <strong>[SWI Prolog]</strong> in <a href="#References">SWI Prolog</a>.
</p>
<h3><a name="FOOT3" href="#DOCF3">(3)</a></h3>
<p>See item <strong>[R]</strong> in <a href="#References">R</a>.
</p>
<h3><a name="FOOT4" href="#DOCF4">(4)</a></h3>
<p>See item <strong>[ggplot2]</strong> in <a href="#References">ggplot2</a>.
</p>
<h3><a name="FOOT5" href="#DOCF5">(5)</a></h3>
<p>See item <strong>[C3js]</strong> in <a href="#References">C3js</a>.
</p>
<h3><a name="FOOT6" href="#DOCF6">(6)</a></h3>
<p>See item <strong>[Cplint on SWISH]</strong> in <a href="#References">Cplint on SWISH</a>.
</p>
<h3><a name="FOOT7" href="#DOCF7">(7)</a></h3>
<p>See item <strong>[SWISH Installer Manual]</strong> in <a href="#References">SWISH Installer Manual</a>.
</p>
<h3><a name="FOOT8" href="#DOCF8">(8)</a></h3>
<p>See item <strong>[Rserve Client]</strong> in <a href="#References">Rserve Client</a>.
</p>
<h3><a name="FOOT9" href="#DOCF9">(9)</a></h3>
<p>See item <strong>[R SWISH]</strong> in <a href="#References">R SWISH</a>.
</p>
<h3><a name="FOOT10" href="#DOCF10">(10)</a></h3>
<p>See item <strong>[Rserve]</strong> in <a href="#References">Rserve</a>.
</p>
<h3><a name="FOOT11" href="#DOCF11">(11)</a></h3>
<p>See item <strong>[gridExtra]</strong> in <a href="#References">gridExtra</a>.
</p>
<h3><a name="FOOT12" href="#DOCF12">(12)</a></h3>
<p>See item <strong>[SWI Prolog data types]</strong> in <a href="#References">SWI Prolog data types</a>.
</p>
<h3><a name="FOOT13" href="#DOCF13">(13)</a></h3>
<p>See item <strong>[LPN]</strong> in <a href="#References">LPN</a>.
</p>
<h3><a name="FOOT14" href="#DOCF14">(14)</a></h3>
<p>See item <strong>[Cplint]</strong> in <a href="#References">Cplint</a>.
</p>
<h3><a name="FOOT15" href="#DOCF15">(15)</a></h3>
<p>See item <strong>[Prolog pack development experience]</strong> in <a href="#References">Prolog pack development experience</a>.
</p>
</div>
<hr>



</body>
</html>
